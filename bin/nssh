#!/bin/bash

# arg1: Target Device
TargetDevice=$1

if [[ `uname` == "Linux" ]]; then
    DEV_HOME_DIR=/home/neruthes/DEV
else
    DEV_HOME_DIR=/Users/Neruthes/Developer
fi

### Decide Username
SSHUsername=neruthes
if [[ ${TargetDevice:0:4} == "NDPS" ]]; then
    SSHUsername=root
fi
if [[ ${TargetDevice:0:4} == "NDVS" ]]; then
    SSHUsername=root
fi
if [[ ${SSHUsername} == "root" ]]; then
    UsernameColor=196
else
    UsernameColor=118
fi

### Decide Address Scope
if [[ ${TargetDevice:0:4} == "NDVS" ]]; then
    AddrScope="wan.neruthes.xyz"
else
    if [[ "$(uname)" == "Linux" ]]; then
        AddrScope="lan"
    fi
    if [[ "$(uname)" == "Darwin" ]]; then
        AddrScope="local"
    fi
fi

echo ""
printf "Establishing SSH connection: \e[38;5;${UsernameColor}m${SSHUsername}\e[0m @ \e[38;5;81m${TargetDevice}.${AddrScope}\e[0m"
echo ""
echo ""

if [[ -r "~/.ssh/$(hostname)" ]]; then
    ### Prefer the keypair which is named after the hostname
    ssh -i "~/.ssh/$(hostname)" "${SSHUsername}@${TargetDevice}.${AddrScope}"
else
    ssh "${SSHUsername}@${TargetDevice}.${AddrScope}"
fi
